name: "Auto-create backfills"

on:
  workflow_call:
    inputs:
      source_branch:
        required: true
        type: string
      master_branch:
        required: false
        type: string
        default: master
      develop_branch:
        required: false
        type: string
        default: idt-develop
jobs:
  update_pull_request:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Create pull requests
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          SOURCE: ${{ inputs.source_branch }}
        run: |
          gh_pr_up() { gh pr create $* || gh pr edit $* }
          gh_pr_up --base master --head $SOURCE --title "$SOURCE master backfill" --body "Auto-generated $SOURCE to master backfill" --label "backfill" --assignee "Civil-Service-Human-Resources/lpg"
          gh_pr_up --base idt-develop --head $SOURCE --title "$SOURCE develop backfill" --body "Auto-generated $SOURCE to develop backfill" --label "backfill" --assignee "Civil-Service-Human-Resources/lpg"
