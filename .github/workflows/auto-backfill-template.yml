name: "Auto-create backfills"

on:
  workflow_call:
    inputs:
      source_branch:
        required: true
        type: string
      master_branch:
        required: true
        type: string
        default: master
      develop_branch:
        required: true
        type: string
        default: idt-develop
jobs:
  update_pull_request:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Create master backfill pull request
        uses: repo-sync/pull-request@v2
        with:
          destination_branch: 'master'
          source_branch: ${{ inputs.source_branch }}
          github_token: ${{ secrets.GITHUB_TOKEN }}
          pr_title: '${{ inputs.source_branch }} master backfill'
          pr_body: 'Auto-generated ${{ inputs.source_branch }} to master backfill'
          pr_label: 'backfill'
          pr_draft: false
          pr_update_method: 'merge'

      - name: Create or Update Pull Request
              uses: repo-sync/pull-request@v2
              with:
                destination_branch: 'idt-develop'
                source_branch: ${{ inputs.source_branch }}
                github_token: ${{ secrets.GITHUB_TOKEN }}
                pr_title: '${{ inputs.source_branch }} idt-develop backfill'
                pr_body: 'Auto-generated ${{ inputs.source_branch }} to idt-develop backfill'
                pr_label: 'backfill'
                pr_draft: false
                pr_update_method: 'merge'