name: "Auto-create backfills"

on:
  workflow_call:
    inputs:
      source_branch:
        required: true
        type: string
      master_branch:
        required: false
        type: string
        default: master
      develop_branch:
        required: false
        type: string
        default: idt-develop
jobs:
  update_pull_request:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3
        run: |
          gh_pr_up() { gh pr create $* || gh pr edit $* }
          gh_pr_up --base master --head ${{ inputs.source_branch }} --title "${{ inputs.source_branch }} master backfill" --body "Auto-generated ${{ inputs.source_branch }} to master backfill" --label "backfill" --assignee "Civil-Service-Human-Resources/lpg"
          gh_pr_up --base idt-develop --head ${{ inputs.source_branch }} --title "${{ inputs.source_branch }} develop backfill" --body "Auto-generated ${{ inputs.source_branch }} to develop backfill" --label "backfill" --assignee "Civil-Service-Human-Resources/lpg"